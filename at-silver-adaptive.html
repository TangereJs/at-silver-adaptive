<link rel="import" href="../tangere/tangere.html" />

<script src="lib/adaptivecards.js"></script>
<link rel="stylesheet" type="text/css" href="theme/teams.css">
<!-- <script src="lib/adaptivecards-visualizer.js"></script> -->

<dom-module id="at-silver-adaptive">
  <template>
    <style>
       :host {
        display: block;
        box-sizing: border-box;
      }

    </style>

    <div id="rcContainer">
      at-silver-adaptive
    </div>
  </template>
</dom-module>
<script>
  Polymer({
    is: "at-silver-adaptive",
    properties: {
      view: {
        type: Object,
        value: function() {
          return null;
        },
        observer: '_viewChanged',
        xtype: 'json'
      }
    },

    $meta: [{
      title: "Adaptive Card",
      type: "element",
      xtype: "at-silver-adaptive",
      events: [],
      icon: "now:wrench"
    }],

    ready: function() { },

    _viewChanged: function(newValue, oldValue) {
      if (!newValue) return;

      var hostConfig = {
        spacing: {
          small: 3,
          default: 8,
          medium: 20,
          large: 30,
          extraLarge: 40,
          padding: 10
        },
        separator: {
          lineThickness: 1,
          lineColor: "#EEEEEE"
        },
        supportsInteractivity: true,
        fontFamily: "Segoe UI",
        fontSizes: {
          small: 12,
          default: 14,
          medium: 17,
          large: 21,
          extraLarge: 26
        },
        fontWeights: {
          lighter: 200,
          default: 400,
          bolder: 600
        },
        containerStyles: {
          default: {
            backgroundColor: "#00000000",
            fontColors: {
              default: {
                normal: "#333333",
                subtle: "#EE333333"
              },
              accent: {
                normal: "#2E89FC",
                subtle: "#882E89FC"
              },
              attention: {
                normal: "#FF0000",
                subtle: "#DDFFD800"
              },
              good: {
                normal: "#00FF00",
                subtle: "#DD00FF00"
              },
              warning: {
                normal: "#FFD800",
                subtle: "#DDFF0000"
              }
            }
          },
          emphasis: {
            backgroundColor: "08000000",
            fontColors: {
              default: {
                normal: "#333333",
                subtle: "#EE333333"
              },
              accent: {
                normal: "#2E89FC",
                subtle: "#882E89FC"
              },
              attention: {
                normal: "#FFD800",
                subtle: "#DDFFD800"
              },
              good: {
                normal: "#00FF00",
                subtle: "#DD00FF00"
              },
              warning: {
                normal: "#FF0000",
                subtle: "#DDFF0000"
              }
            }
          }
        },
        imageSizes: {
          small: 40,
          medium: 80,
          large: 160
        },
        actions: {
          maxActions: 3,
          spacing: 2,
          buttonSpacing: 10,
          showCard: {
            actionMode: "inline",
            inlineTopMargin: 16
          },
          actionsOrientation: 0,
          actionAlignment: 0
        },
        adaptiveCard: {
          allowCustomStyle: false
        },
        image: {
          size: "medium",
        },
        imageSet: {
          imageSize: "medium",
          maxImageHeight: 100
        },
        factSet: {
          title: {
            color: "default",
            size: "default",
            isSubtle: false,
            weight: "bolder",
            wrap: true,
            maxWidth: 150
          },
          value: {
            color: "default",
            size: "default",
            isSubtle: false,
            weight: "default",
            wrap: true
          },
          spacing: 10
        }
      };
      
      var adaptiveCard = new AdaptiveCards.AdaptiveCard();
      adaptiveCard.hostConfig = hostConfig;
      adaptiveCard.parse(newValue);
      var renderedCard = adaptiveCard.render();

      Polymer.dom(this.$.rcContainer).innerHTML = "";
      Polymer.dom(this.$.rcContainer).appendChild(renderedCard);
    }
  });

</script>
